# Visualization, revisited

Now that we have some wrangling experience, we can create some more complex visualizations. This section will be mostly practice questions, promoting active learning and help-finding. 

## Facets

Facets are a way to lay out related plots in a grid. For example, maybe we want to look at hourly patterns by the day of the week.

```{r}
ggplot(nice_ride_2018, aes(x = start_hour)) +
  geom_density(adjust = 1.5) + # the adjust argument just makes the plots a little smoother
  facet_wrap(~start_day) + # lay out the plots by the weekday
  theme_minimal()
```


## Practice

* Create a plot of the ten most popular start stations for `Classic` bikes on Saturdays and Sundays.

Should look like:

```{r echo = FALSE}
nice_ride_2018 %>%
  filter(start_day %in% c("Sat", "Sun") & bike_type == "Classic") %>%
  group_by(start_station_name) %>%
  count() %>%
  arrange(desc(n)) %>%
  head(10) %>%
  ggplot(aes(x = start_station_name, y = n)) +
  geom_col() +
  theme_minimal() +
  theme(axis.text = element_text(angle = 60, hjust = 1))
```

* Create a plot of the ten most popular end stations for `Classic` bikes on the weekdays.

```{r echo = FALSE}
nice_ride_2018 %>%
  filter(!start_day %in% c("Sat", "Sun") & bike_type == "Classic") %>%
  group_by(end_station_name) %>%
  count() %>%
  arrange(desc(n)) %>%
  head(10) %>%
  ggplot(aes(x = end_station_name, y = n)) +
  geom_col() +
  theme_minimal() +
  theme(axis.text = element_text(angle = 60, hjust = 1))
```

* Create a plot of the 10 most common origin-destination pairs (filter out NULL stations first).

Hints: create a variable of the origin destination pair name with `paste(start_station_name, end_station_name, sep = " to ")` plus a wrangling verb. Look into `coord_flip()`.

```{r echo = FALSE}
nice_ride_2018 %>%
  filter(start_station_name != "NULL") %>%
  group_by(start_station_name, end_station_name) %>%
  summarise(trips = n()) %>%
  arrange(desc(trips)) %>%
  head(10) %>%
  mutate(or_dest = paste(start_station_name, end_station_name, sep = " to ")) %>%
  ggplot(aes(x = or_dest, y = trips)) +
  geom_col() +
  coord_flip() + theme_minimal() +
  labs(title = "Round trips are popular among \nNiceride users, especially \nin the parks", x = "Origin - Destination Pair", y = "Trips")
```

* Create an overlapping density plot of hourly use by user type facetted by weekday (similar to above).

```{r echo = FALSE}
ggplot(nice_ride_2018, aes(x = start_hour, fill = usertype)) +
  geom_density(adjust = 1.5, alpha = 0.5) + # the adjust argument just makes the plots a little smoother
  facet_wrap(~start_day) + # lay out the plots by the weekday
  theme_minimal()
```

* Then [change the colors](https://ggplot2.tidyverse.org/reference/scale_manual.html) on that plot

```{r echo = FALSE}
ggplot(nice_ride_2018, aes(x = start_hour, fill = usertype)) +
  geom_density(adjust = 1.5, alpha = 0.6) + # the adjust argument just makes the plots a little smoother
  facet_wrap(~start_day) + # lay out the plots by the weekday
  theme_minimal() +
  scale_fill_manual(values = c("#C0E6DE", "#FED18C"))
```

* And add better labels, including a legend title (read the help doc from above).

```{r echo = FALSE}
ggplot(nice_ride_2018, aes(x = start_hour, fill = usertype)) +
  geom_density(adjust = 1.5, alpha = 0.6) + # the adjust argument just makes the plots a little smoother
  facet_wrap(~start_day) + # lay out the plots by the weekday
  theme_minimal() +
  scale_fill_manual(values = c("#C0E6DE", "#FED18C"), name = "User Type") +
  labs(title = "Subscribers use Niceride in a predictable commuter pattern", y = "", x = "Start time")
```

